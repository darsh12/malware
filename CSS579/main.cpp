// CSS579.cpp : This file contains the 'main' function. Program execution begins and ends there.
//

#include <iostream>
#include <Windows.h>
#include <stdio.h>
#include <string.h>
#include <cstdlib>

using namespace std;

//Depending on the call type you can use _stdcall or _cdecl
typedef int(_stdcall* Msg) (HWND, LPCSTR, LPCSTR, UINT);

HINSTANCE LLibray(LPCWSTR dllToLoad);

int main()
{
    std::cout << "Hello World!\n";

	//Get handle to user32.dll
	HINSTANCE hDll = LLibray(TEXT("Use32.dll"));


	printf("Lib Loaded");
	Msg MsgBox = (Msg)GetProcAddress(hDll, "MessageBoxA");
	MsgBox(NULL, "Test", "test", 0);

	//Release the library
	FreeLibrary(hDll);
	return 0;

}



//Function to load library
HINSTANCE LLibray(LPCWSTR dllToLoad) {
	HINSTANCE hDll = LoadLibrary(dllToLoad);

	if (hDll == NULL) {
		
		wprintf(L"Error getting handle to: %s",dllToLoad);
		exit(1);
	}
	
	return hDll;
}
